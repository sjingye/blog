(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{49:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),a("p",[t._v("React 没有提供将可复用性行为“附加”到组件的途径，之前的解决方案有：比如 render props 和 高阶组件。但是这类方案需要重新组织你的组件结构，这可能会很麻烦。")]),t._v(" "),a("p",[t._v("可以使用 Hook 从组件中提取状态逻辑，使得这些逻辑可以单独测试并复用。Hook 使你在无需修改组件结构的情况下复用状态逻辑。 这使得在组件间或社区内共享 Hook 变得更便捷。")]),t._v(" "),t._m(3),t._v(" "),a("p",[t._v("组件起初很简单，但是逐渐会被状态逻辑和副作用充斥。每个生命周期常常包含一些不相关的逻辑。")]),t._v(" "),t._m(4),t._v(" "),a("p",[t._v("比如 this 指向等")]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),a("p",[a("strong",[t._v("from Dan：")]),a("br"),t._v(" "),a("a",{attrs:{href:"https://overreacted.io/zh-hans/why-do-hooks-rely-on-call-order/",target:"_blank",rel:"noopener noreferrer"}},[t._v("为什么顺序调用对 React Hooks 很重要？"),a("OutboundLink")],1)]),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._m(16),t._v(" "),a("p",[a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-intro.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Hooks FAQ"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/163493445",target:"_blank",rel:"noopener noreferrer"}},[t._v("JS 核心理论之《React 状态复用与 Hooks 用法"),a("OutboundLink")],1)])])}),[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"hooks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hooks"}},[this._v("#")]),this._v(" Hooks")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"解决的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决的问题"}},[this._v("#")]),this._v(" 解决的问题")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_1-在组件之间复用状态逻辑很难"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-在组件之间复用状态逻辑很难"}},[this._v("#")]),this._v(" 1.在组件之间复用状态逻辑很难")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-复杂组件变得难以理解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-复杂组件变得难以理解"}},[this._v("#")]),this._v(" 2.复杂组件变得难以理解")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-难以理解的-class"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-难以理解的-class"}},[this._v("#")]),this._v(" 3.难以理解的 class")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"hook-规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hook-规则"}},[this._v("#")]),this._v(" Hook 规则")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("p",[this._v("只在最顶层使用 Hook，不要在循环，条件或嵌套函数中调用 Hook"),s("br"),this._v("\n因为 React 靠的是 Hook 调用的顺序，来正确地将内部 state 和对应的 Hook 进行关联，所以需要 Hook 的调用顺序在每次渲染中都是相同的。")])]),this._v(" "),s("li",[s("p",[this._v("只在 React 函数中调用 Hook，不在普通的 JavaScript 函数中调用 Hook。你可以："),s("br"),this._v("\n✅ 在 React 的函数组件中调用 Hook"),s("br"),this._v("\n✅ 在自定义 Hook 中调用其他 Hook")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"实现一个-usestate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现一个-usestate"}},[this._v("#")]),this._v(" 实现一个 useState")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("特点：")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ol",[a("li",[t._v("一个 useState 的基本结构，它接收一个初始值，返回一个状态和一个改变状态的函数")]),t._v(" "),a("li",[t._v("状态存储的实现\n"),a("ul",[a("li",[t._v("新状态替换旧状态")]),t._v(" "),a("li",[t._v("重新渲染组件")])])]),t._v(" "),a("li",[t._v("多个 state 并存")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("initialValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" initialValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("setState")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 触发视图重新渲染")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" setState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("blockquote",[a("p",[t._v("this.setState 与 useState 区别")]),t._v(" "),a("ol",[a("li",[t._v("通过 useState 的 setXXX 修改数据，不会和 setState 一样进行对象属性合并，会直接覆盖。")]),t._v(" "),a("li",[t._v("Hooks 函数组件中，存在渲染闭包的概念，在一次渲染闭包中，state 是固定不变的。")]),t._v(" "),a("li",[t._v("Hooks 函数组件，默认开启类"),a("code",[t._v("Object.is")]),t._v("的浅层比较，类似默认开启 PureComponent 的优化方式。")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"实现一个-useeffect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现一个-useeffect"}},[this._v("#")]),this._v(" 实现一个 useEffect")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("特点：")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("有两个参数 callback 和 dependencies 数组")]),this._v(" "),s("li",[this._v("如果 dependencies 不存在，那么 callback 每次 render 都会执行")]),this._v(" "),s("li",[this._v("如果 dependencies 存在，只有当它发生了变化， callback 才会执行")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" deps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" depArray")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果 dependencies 不存在")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" shouldUpdate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("depArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 两次的 dependencies 是否完全相等")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" depsChange "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" deps\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("depArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("every")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("depItem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" depItem "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" deps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 如果 dependencies 不存在，或者 dependencies 有变化*/")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("shouldUpdate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" depsChange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    deps "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" depArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"学习资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#学习资料"}},[this._v("#")]),this._v(" 学习资料")])}],!1,null,null,null);s.default=n.exports}}]);